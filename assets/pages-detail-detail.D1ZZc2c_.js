import{r as t,f as e,p as s,s as a,t as i,O as o,ar as l,l as n,z as r,k as c,C as d,A as u,m,N as h,ad as f,T as p,as as g,at as _,au as k,av as I,$ as y,a4 as C,a2 as w,h as v,a3 as b,aw as M,ax as $,n as S,ay as T,M as P,az as N,Z as D,aA as x,x as B,y as F,aB as A,B as H,c as U,w as E,i as L,o as q,a as R,b as V,H as O,K as J,G as z,D as j,E as W,F as G,J as K,e as Y,d as Z,aC as Q,I as X,a5 as tt,S as et,aD as st}from"./index-9XL5VAeM.js";import{r as at,_ as it}from"./uni-app.es.CfXeMcxE.js";import{_ as ot}from"./_plugin-vue_export-helper.BCo6x5W8.js";const lt=ot({data:()=>({postId:null,post:{},comments:[],newComment:"",newCommentImage:"",categoryName:"",isMod:!1,canDelete:!1,isAuthor:!1,isLiked:!1,isFavorited:!1,likeCount:0,currentPrice:0,refreshInterval:null,showBidModal:!1,bidPrice:"",currentUserId:"",auctionEndTime:null,countdownText:"",showTimerModal:!1,timerMinutes:"",timerInterval:null,bidHistory:[],uniqueBidders:[],showBidHistoryModal:!1}),computed:{isAuctionEnded(){if(!this.auctionEndTime)return!1;return Math.floor(Date.now()/1e3)>=this.auctionEndTime}},onLoad(e){this.postId=e.id,this.comments=[],this.bidHistory=[];const s=t();s&&(this.currentUserId=s.id),this.checkUserStatus(),this.loadPost(),this.loadComments(),this.refreshInterval=setInterval((()=>{this.loadPost(!0),this.loadComments(!0)}),5e3)},onUnload(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null),this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)},onHide(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null),this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)},onShow(){this.postId&&(this.loadPost(),this.loadComments(),this.refreshInterval||(this.refreshInterval=setInterval((()=>{this.loadPost(!0),this.loadComments(!0)}),5e3)));const e=t();this.currentUserId=e?e.id:""},onPullDownRefresh(){this.postId&&(this.loadPost(),this.loadComments()),setTimeout((()=>{e()}),1e3)},methods:{startChat(e,a){t()?s({url:`/pages/message/chat?targetUserId=${e}&targetUserName=${a}`}):s({url:"/pages/login/login"})},goToUserProfile(e){if(e){const i=t();i&&String(i.id)===String(e)?a({url:"/pages/profile/profile"}):s({url:`/pages/profile/public_profile?userId=${e}`})}},getRole:t=>i(t),async checkUserStatus(){if(t()){await o();const e=t();this.post&&this.post.id&&(this.canDelete=l(e,this.post),this.isMod=l(e,{...this.post,authorId:"system"}))}},async loadComments(t=!1){const{data:e,error:s}=await n(this.postId);if(s)return void(t||console.error("Failed to load comments:",s));const a=(e||[]).map((t=>{let e=t.authorAvatar||"";return!e&&t.authorId&&(e=r(t.authorId)),!e&&this.post&&this.post.authorId===t.authorId&&(e=this.post.authorAvatar||r(this.post.authorId)),e||(e=`https://ui-avatars.com/api/?name=${encodeURIComponent(t.authorName||"User")}&background=random&color=fff&size=128`),{...t,authorAvatar:e}}));if(this.post&&"auction"===this.post.type){let t=parseFloat(this.post.price)||0,e=[],s=new Set;a.forEach((a=>{let i=0,o=!1;const l=a.text.trim();if(l.includes("å‡ºåƒ¹")){const t=l.match(/(\d+)/);t&&(i=parseFloat(t[1]),o=!0)}else o=!1;o&&(e.push({price:i,userName:a.authorName,userId:a.authorId,avatar:a.authorAvatar,timestamp:a.timestamp}),i>t&&(t=i),a.authorId&&a.authorId!==this.currentUserId&&s.add(JSON.stringify({id:a.authorId,name:a.authorName})))})),this.uniqueBidders=Array.from(s).map((t=>JSON.parse(t))),(a.length>0||0===this.bidHistory.length)&&(this.currentPrice=t,e.sort(((t,e)=>e.price-t.price)),this.bidHistory=e.slice(0,10))}this.comments=a.filter((t=>!t.text.trim().match(/^å‡ºåƒ¹ \$\d+(\.\d+)?$/)))},loadPost(e=!1){const s=c().find((t=>t.id===this.postId));if(s){if("auction"!==s.type&&(this.currentPrice=s.price),JSON.stringify(this.post)!==JSON.stringify(s)&&(this.post=s,this.likeCount=this.post.likes?this.post.likes.length:0,this.post.auctionEndTime&&(this.auctionEndTime=parseInt(this.post.auctionEndTime),this.startLocalTimer()),this.post.categoryId)){const t=d.find((t=>t.id===this.post.categoryId));if(t)if(this.post.subCategoryId&&t.children){const e=t.children.find((t=>t.id===this.post.subCategoryId));this.categoryName=e?`${t.name} - ${e.name}`:t.name}else this.categoryName=t.name}if(!e){const e=t();if(e){this.isLiked=this.post.likes&&this.post.likes.includes(e.id);const t=u(`favorites_${e.id}`)||[];this.isFavorited=t.includes(this.postId),this.checkUserStatus()}e&&this.post.authorId===e.id&&(this.isAuthor=!0)}}},placeBid(){if(this.isAuctionEnded)return void m({title:"æ‹è³£å·²çµæŸï¼Œç„¡æ³•å‡ºåƒ¹",icon:"none"});t()?(this.bidPrice="",this.showBidModal=!0):s({url:"/pages/login/login"})},closeBidModal(){this.showBidModal=!1},async confirmBid(){if(!this.bidPrice)return void m({title:"è«‹è¼¸å…¥é‡‘é¡",icon:"none"});const t=parseFloat(this.bidPrice);if(isNaN(t)||t<=this.currentPrice)return void m({title:"å‡ºåƒ¹å¿…é ˆé«˜æ–¼ç•¶å‰åƒ¹æ ¼",icon:"none"});this.showBidModal=!1,this.newComment=`å‡ºåƒ¹ $${t}`;const e=this.currentPrice;this.currentPrice=t;try{await this.addComment(),await h(this.postId,{price:t.toString()});let e=c();const s=e.findIndex((t=>t.id===this.postId));-1!==s&&(e[s].price=t,f(e))}catch(s){console.error("Bid error:",s),this.currentPrice=e,m({title:"å‡ºåƒ¹å¤±æ•—",icon:"none"})}},async toggleLike(){const e=t();if(!e)return void s({url:"/pages/login/login"});let a=c();const i=a.findIndex((t=>t.id===this.postId));if(-1!==i){if(a[i].likes||(a[i].likes=[]),this.isLiked){const t=a[i].likes.indexOf(e.id);t>-1&&a[i].likes.splice(t,1),this.isLiked=!1,this.likeCount--}else a[i].likes.push(e.id),this.isLiked=!0,this.likeCount++;f(a),this.post=a[i];try{await h(this.postId,{likes:JSON.stringify(this.post.likes)})}catch(o){console.error("Sync like error:",o)}}},toggleFavorite(){const e=t();if(!e)return void s({url:"/pages/login/login"});let a=u(`favorites_${e.id}`)||[];if(this.isFavorited){const t=a.indexOf(this.postId);t>-1&&a.splice(t,1),this.isFavorited=!1,m({title:"å·²å–æ¶ˆæ”¶è—",icon:"none"})}else a.push(this.postId),this.isFavorited=!0,m({title:"æ”¶è—æˆåŠŸ"});p(`favorites_${e.id}`,a)},sharePost(){g({itemList:["åˆ†äº«çµ¦ WhatsApp å¥½å‹","åˆ†äº«çµ¦å¾®ä¿¡å¥½å‹","è¤‡è£½é‚€è«‹éˆæ¥"],success:t=>{const e=`${_}/#/pages/detail/detail?id=${this.postId}`,s=`çœ‹çœ‹é€™å€‹å¸–å­ï¼š${this.post.title}\n${e}`;0===t.tapIndex?window.location.href=`https://wa.me/?text=${encodeURIComponent(s)}`:1===t.tapIndex?m({title:"è«‹è¤‡è£½éˆæ¥åˆ†äº«",icon:"none"}):k({data:s,success:()=>m({title:"éˆæ¥å·²è¤‡è£½"})})}})},scrollToComments(t=null){I().in(this).select("#comments-section").boundingClientRect((t=>{t&&y({scrollTop:t.top,duration:300})})).exec(),t&&(this.newComment=`å›å¤ @${t}: `)},viewImage(t){C({urls:this.post.images||[this.post.image],current:t})},viewCommentImage(t){C({urls:[t]})},chooseCommentImage(){w({count:1,success:t=>{this.newCommentImage=t.tempFilePaths[0]}})},removeCommentImage(){this.newCommentImage=""},async addComment(){if(!this.newComment.trim()&&!this.newCommentImage)return;const t=u("currentUser");if(t){v({title:"ç™¼é€ä¸­..."});try{let e="";if(this.newCommentImage&&!this.newCommentImage.startsWith("http")){const{data:t,error:s}=await b(this.newCommentImage);s?console.error("Comment image upload failed",s):t&&t.url&&(e=t.url)}else e=this.newCommentImage;const s={postId:this.postId,authorId:t.id,authorName:t.name,authorAvatar:t.avatar||"",text:this.newComment,image:e,timestamp:Math.floor(Date.now()/1e3)},{data:a,error:i}=await M(s);if(i)throw new Error(i);if("auction"===this.post.type&&this.newComment.trim().match(/^å‡ºåƒ¹ \$\d+(\.\d+)?$/)){const e=this.newComment.trim().match(/(\d+)/);if(e){const s=parseFloat(e[1]);s>this.currentPrice&&(this.currentPrice=s),this.bidHistory.unshift({price:s,userName:t.name,userId:t.id,avatar:t.avatar||r(t.id),timestamp:Math.floor(Date.now()/1e3)}),this.bidHistory=this.bidHistory.slice(0,10)}}else a.authorAvatar=t.avatar||r(t.id),this.comments.push(a);if(this.newComment="",this.newCommentImage="",$(t.id,2),S(),m({title:"è©•è«–æˆåŠŸ +2 äººæ°£å€¼",icon:"none"}),this.post.authorId!==t.id){const e={id:Date.now().toString(),userId:this.post.authorId,type:"reply",title:"æ–°å›å¾©é€šçŸ¥",content:`${t.name} å›è¦†äº†æ‚¨çš„å¸–å­ï¼š${this.post.title}`,postId:this.postId,timestamp:Date.now(),read:!1};T(e)}}catch(e){S(),console.error("Add comment error:",e),m({title:"ç™¼é€å¤±æ•—: "+(e.message||"Unknown"),icon:"none"})}}else s({url:"/pages/login/login"})},editPost(){s({url:`/pages/create/create?edit=true&id=${this.postId}`})},async deletePost(){P({title:"ç¢ºèªåˆªé™¤",content:"ç¢ºå®šè¦åˆªé™¤æ­¤å¸–å­å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚",success:async t=>{if(t.confirm){v({title:"åˆªé™¤ä¸­..."});try{const{error:t}=await N(this.postId);t&&console.error("Delete cloud post error",t);const e=c().filter((t=>t.id!==this.postId));f(e),S(),m({title:"å¸–å­å·²åˆªé™¤"}),setTimeout((()=>{D()}),1e3)}catch(e){S(),m({title:"åˆªé™¤å¤±æ•—",icon:"none"})}}}})},async deleteComment(t){const e=this.comments[t];e&&P({title:"ç¢ºèªåˆªé™¤",content:"ç¢ºå®šè¦åˆªé™¤æ­¤è©•è«–å—ï¼Ÿ",success:async s=>{if(s.confirm){v({title:"åˆªé™¤ä¸­..."});const{error:s}=await x(e.$id);if(s)return S(),void m({title:"åˆªé™¤å¤±æ•—",icon:"none"});this.comments.splice(t,1),"auction"===this.post.type&&this.loadComments(!0),S(),m({title:"è©•è«–å·²åˆªé™¤"})}}})},formatDate(t){if(!t)return"";const e=new Date(t<1e10?1e3*t:t);return`${e.getMonth()+1}/${e.getDate()} ${e.getHours()}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`},formatDateShort(t){if(!t)return"";const e=new Date(t<1e10?1e3*t:t),s=new Date;return e.toDateString()===s.toDateString()?`${e.getHours()}:${e.getMinutes().toString().padStart(2,"0")}`:`${e.getMonth()+1}/${e.getDate()}`},getLevel:t=>B(t),getPoints:t=>F(t),getAvatar:t=>r(t),openTimerModal(){this.timerMinutes="5",this.showTimerModal=!0},closeTimerModal(){this.showTimerModal=!1},async confirmStartTimer(){if(!this.timerMinutes||isNaN(this.timerMinutes)||parseFloat(this.timerMinutes)<=0)return void m({title:"è«‹è¼¸å…¥æœ‰æ•ˆçš„åˆ†é˜æ•¸",icon:"none"});v({title:"è¨­å®šä¸­..."});const t=parseFloat(this.timerMinutes),e=Math.floor(Date.now()/1e3)+60*t;try{await h(this.postId,{auctionEndTime:e.toString()}),this.auctionEndTime=e;let s=c();const a=s.findIndex((t=>t.id===this.postId));if(-1!==a&&(s[a].auctionEndTime=e.toString(),f(s)),this.startLocalTimer(),this.showTimerModal=!1,this.newComment=`ğŸ“¢ æ‹è³£å€’æ•¸å·²å•Ÿå‹•ï¼å°‡æ–¼ ${t} åˆ†é˜å¾Œæˆªæ¨™ã€‚`,await this.addComment(),this.uniqueBidders&&this.uniqueBidders.length>0){console.log(`Notifying ${this.uniqueBidders.length} bidders...`);const e=this.uniqueBidders.map((e=>A({senderId:this.currentUserId,receiverId:e.id,text:`ğŸ”” æ‹è³£å€’æ•¸é€šçŸ¥ï¼šæ‚¨åƒèˆ‡çš„å¸–å­ã€Œ${this.post.title}ã€å·²å•Ÿå‹•å€’æ•¸ï¼Œå°‡æ–¼ ${t} åˆ†é˜å¾Œæˆªæ¨™ï¼`,timestamp:Math.floor(Date.now()/1e3),read:!1})));Promise.all(e).then((t=>{const e=t.filter((t=>!t.error)).length;console.log(`Successfully notified ${e} bidders`),m(e>0?{title:`å€’æ•¸é–‹å§‹ï¼å·²é€šçŸ¥ ${e} ä½è²·å®¶`,icon:"none",duration:3e3}:{title:"å€’æ•¸é–‹å§‹ï¼",icon:"success"})}))}else m({title:"å€’æ•¸é–‹å§‹ï¼",icon:"success"});S()}catch(s){S(),console.error("Start timer error:",s),m({title:"è¨­å®šå¤±æ•—ï¼Œè«‹ç¢ºä¿å¾Œå°å·²æ–°å¢ auctionEndTime æ¬„ä½",icon:"none"})}},startLocalTimer(){this.timerInterval&&clearInterval(this.timerInterval),this.updateTimerDisplay(),this.timerInterval=setInterval((()=>{this.updateTimerDisplay()}),1e3)},updateTimerDisplay(){if(!this.auctionEndTime)return;const t=Math.floor(Date.now()/1e3);let e=this.auctionEndTime-t;if(e<=0)return void(this.countdownText="00:00:00");const s=Math.floor(e/3600),a=Math.floor(e%3600/60),i=e%60;this.countdownText=`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},openBidHistoryModal(){this.showBidHistoryModal=!0},closeBidHistoryModal(){this.showBidHistoryModal=!1},formatDateFull(t){if(!t)return"";const e=new Date(t<1e10?1e3*t:t);return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`}}},[["render",function(t,e,s,a,i,o){const l=Y,n=L,r=Z,c=st,d=Q,u=X,m=tt,h=et,f=at(H("app-tab-bar"),it);return q(),U(n,{class:"container"},{default:E((()=>[R(n,{class:"notice-bar"},{default:E((()=>[R(n,{class:"notice-content"},{default:E((()=>[R(l,{class:"notice-text"},{default:E((()=>[V("ğŸ“¢ æœ¬ç‰ˆç‰ˆè¦ï¼šåš´ç¦ç™¼ä½ˆä»»ä½•è‰²æƒ…ã€æš´åŠ›ã€è³­åšåŠè©é¨™è¨Šæ¯ã€‚è«‹ä¿æŒç¦®è²Œï¼Œå°Šé‡ä»–äººã€‚é•è€…å°‡è¢«å°ç¦ã€‚")])),_:1})])),_:1})])),_:1}),R(n,{class:"post-detail"},{default:E((()=>[R(l,{class:"post-title"},{default:E((()=>[V(O(i.post.title),1)])),_:1}),"auction"===i.post.type?(q(),U(n,{key:0,class:"auction-info"},{default:E((()=>[R(n,{class:"auction-header-row"},{default:E((()=>[R(l,{class:"auction-tag"},{default:E((()=>[V("ğŸ”¨ æ‹è³£ä¸­")])),_:1}),R(l,{class:"auction-price"},{default:E((()=>[V("ç•¶å‰å‡ºåƒ¹: $"+O(i.currentPrice),1)])),_:1})])),_:1}),R(n,{class:"auction-action-row"},{default:E((()=>[i.auctionEndTime?(q(),U(n,{key:0,class:"countdown-display"},{default:E((()=>[R(l,{class:"countdown-label"},{default:E((()=>[V(O(o.isAuctionEnded?"ğŸ”´ æ‹è³£å·²çµæŸ":"â° çµæ¨™å€’æ•¸"),1)])),_:1}),R(l,{class:J(["countdown-time",{ended:o.isAuctionEnded}])},{default:E((()=>[V(O(i.countdownText),1)])),_:1},8,["class"])])),_:1})):z("",!0),i.isAuthor&&!i.auctionEndTime?(q(),U(n,{key:1,class:"set-timer-btn",onClick:o.openTimerModal},{default:E((()=>[R(l,null,{default:E((()=>[V("â±ï¸ è¨­å®šå€’æ•¸")])),_:1})])),_:1},8,["onClick"])):z("",!0),R(n,{class:J(["bid-btn",{disabled:o.isAuctionEnded}]),onClick:o.placeBid},{default:E((()=>[R(l,null,{default:E((()=>[V(O(o.isAuctionEnded?"ğŸ›‘ åœæ­¢å‡ºåƒ¹":"ğŸ’° åƒèˆ‡æ‹è³£"),1)])),_:1})])),_:1},8,["class","onClick"])])),_:1})])),_:1})):z("",!0),R(n,{class:"post-meta"},{default:E((()=>[R(n,{class:"author-row"},{default:E((()=>[R(r,{src:o.getAvatar(i.post.authorId)||"/static/logo.png",class:"post-user-avatar",mode:"aspectFill",onClick:e[0]||(e[0]=t=>o.goToUserProfile(i.post.authorId))},null,8,["src"]),R(l,{class:"author"},{default:E((()=>[V(O(i.post.authorName),1)])),_:1}),o.getRole(i.post.authorName)?(q(),U(n,{key:0,class:J(["role-badge",o.getRole(i.post.authorName).type])},{default:E((()=>[R(l,null,{default:E((()=>[V(O(o.getRole(i.post.authorName).label),1)])),_:1})])),_:1},8,["class"])):z("",!0),i.post.authorId?(q(),U(n,{key:1,class:"user-stats"},{default:E((()=>[R(l,{class:"stat-badge level"},{default:E((()=>[V("Lv."+O(o.getLevel(i.post.authorId)),1)])),_:1}),R(l,{class:"stat-badge points"},{default:E((()=>[V("ğŸ”¥"+O(o.getPoints(i.post.authorId)),1)])),_:1})])),_:1})):z("",!0),i.post.authorId&&String(i.post.authorId)!==String(i.currentUserId)?(q(),U(n,{key:2,class:"pm-btn",onClick:e[1]||(e[1]=t=>o.startChat(i.post.authorId,i.post.authorName))},{default:E((()=>[R(l,null,{default:E((()=>[V("âœ‰ï¸ ç§ä¿¡")])),_:1})])),_:1})):z("",!0),i.isAuthor||i.canDelete?(q(),U(n,{key:3,class:"action-group"},{default:E((()=>[i.isAuthor?(q(),U(n,{key:0,class:"action-btn edit",onClick:o.editPost},{default:E((()=>[R(l,null,{default:E((()=>[V("âœï¸")])),_:1})])),_:1},8,["onClick"])):z("",!0),i.canDelete?(q(),U(n,{key:1,class:"action-btn delete",onClick:o.deletePost},{default:E((()=>[R(l,null,{default:E((()=>[V("ğŸ—‘ï¸")])),_:1})])),_:1},8,["onClick"])):z("",!0)])),_:1})):z("",!0)])),_:1}),R(l,{class:"time"},{default:E((()=>[V(O(o.formatDate(i.post.timestamp)),1)])),_:1})])),_:1}),R(n,{class:"tags-row"},{default:E((()=>[i.categoryName?(q(),U(n,{key:0,class:"category-tag"},{default:E((()=>[R(l,null,{default:E((()=>[V("#"+O(i.categoryName),1)])),_:1})])),_:1})):z("",!0)])),_:1}),i.post.images&&i.post.images.length>0?(q(),U(n,{key:1,class:"image-section"},{default:E((()=>[R(d,{class:"image-swiper","indicator-dots":"true",autoplay:"false"},{default:E((()=>[(q(!0),j(G,null,W(i.post.images,((t,e)=>(q(),U(c,{key:e},{default:E((()=>[R(r,{src:t,mode:"aspectFit",class:"post-image",onClick:t=>o.viewImage(e)},null,8,["src","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})):i.post.image?(q(),U(r,{key:2,src:i.post.image,mode:"widthFix",class:"post-image"},null,8,["src"])):z("",!0),R(l,{class:"post-content"},{default:E((()=>[V(O(i.post.content),1)])),_:1})])),_:1}),"auction"===i.post.type&&i.bidHistory.length>0?(q(),U(n,{key:0,class:"bid-history-bar",onClick:o.openBidHistoryModal},{default:E((()=>[R(n,{class:"bid-history-left"},{default:E((()=>[R(l,{class:"trophy-icon"},{default:E((()=>[V("ğŸ†")])),_:1}),R(l,{class:"history-label"},{default:E((()=>[V("å‡ºåƒ¹ç´€éŒ„")])),_:1}),R(l,{class:"tap-hint"},{default:E((()=>[V("(é»æ“ŠæŸ¥çœ‹è©³æƒ…)")])),_:1})])),_:1}),R(d,{class:"bid-swiper",vertical:"true",autoplay:"true",circular:"true",interval:"3000",duration:"800"},{default:E((()=>[(q(!0),j(G,null,W(i.bidHistory,((t,e)=>(q(),U(c,{key:e,class:"bid-swiper-item-wrap"},{default:E((()=>[R(n,{class:"bid-swiper-item"},{default:E((()=>[R(n,{class:"bid-user-info"},{default:E((()=>[R(r,{src:t.avatar||"/static/logo.png",class:"bid-avatar-small",mode:"aspectFill"},null,8,["src"]),R(l,{class:"bid-user-name"},{default:E((()=>[V(O(t.userName),1)])),_:2},1024)])),_:2},1024),R(n,{class:"bid-price-info"},{default:E((()=>[R(l,{class:"bid-price-tag"},{default:E((()=>[V("$"+O(t.price),1)])),_:2},1024),0===e?(q(),U(l,{key:0,class:"rank-badge"},{default:E((()=>[V("ğŸ‘‘ é ˜å…ˆ")])),_:1})):(q(),U(l,{key:1,class:"rank-time"},{default:E((()=>[V(O(o.formatDateShort(t.timestamp)),1)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1},8,["onClick"])):z("",!0),R(n,{class:"comments-section",id:"comments-section"},{default:E((()=>[R(l,{class:"section-title"},{default:E((()=>[V("è©•è«– ("+O(i.comments.length)+")",1)])),_:1}),R(n,{class:"comment-list"},{default:E((()=>[(q(!0),j(G,null,W(i.comments,((t,e)=>(q(),U(n,{key:e,class:"comment-item"},{default:E((()=>[R(r,{src:t.authorAvatar||"/static/logo.png",class:"comment-user-avatar",mode:"aspectFill",onClick:e=>o.goToUserProfile(t.authorId)},null,8,["src","onClick"]),R(n,{class:"comment-content-wrapper"},{default:E((()=>[R(n,{class:"comment-header"},{default:E((()=>[R(n,{class:"comment-author-group"},{default:E((()=>[R(l,{class:"comment-author"},{default:E((()=>[V(O(t.authorName),1)])),_:2},1024),o.getRole(t.authorName)?(q(),U(n,{key:0,class:J(["role-badge","small",o.getRole(t.authorName).type])},{default:E((()=>[R(l,null,{default:E((()=>[V(O(o.getRole(t.authorName).label),1)])),_:2},1024)])),_:2},1032,["class"])):z("",!0),R(l,{class:"stat-badge level"},{default:E((()=>[V("Lv."+O(o.getLevel(t.authorId)),1)])),_:2},1024),t.authorId&&String(t.authorId)!==String(i.currentUserId)?(q(),U(n,{key:1,class:"small-pm-btn",onClick:K((e=>o.startChat(t.authorId,t.authorName)),["stop"])},{default:E((()=>[R(l,null,{default:E((()=>[V("ğŸ’¬")])),_:1})])),_:2},1032,["onClick"])):z("",!0)])),_:2},1024),R(n,{class:"header-right"},{default:E((()=>[R(l,{class:"comment-time"},{default:E((()=>[V(O(o.formatDate(t.timestamp)),1)])),_:2},1024),i.isMod?(q(),U(l,{key:0,class:"delete-comment-btn",onClick:t=>o.deleteComment(e)},{default:E((()=>[V("ğŸ—‘ï¸")])),_:2},1032,["onClick"])):z("",!0)])),_:2},1024)])),_:2},1024),R(l,{class:"comment-text"},{default:E((()=>[V(O(t.text),1)])),_:2},1024),t.image?(q(),U(r,{key:0,src:t.image,mode:"widthFix",class:"comment-image",onClick:e=>o.viewCommentImage(t.image)},null,8,["src","onClick"])):z("",!0)])),_:2},1024)])),_:2},1024)))),128)),0===i.comments.length?(q(),U(n,{key:0,class:"no-comments"},{default:E((()=>[R(l,null,{default:E((()=>[V("æš«ç„¡è©•è«–ï¼Œå¿«ä¾†æ¶æ²™ç™¼ï¼")])),_:1})])),_:1})):z("",!0)])),_:1})])),_:1}),R(n,{class:"comment-input-area"},{default:E((()=>[i.newCommentImage?(q(),U(n,{key:0,class:"comment-image-preview"},{default:E((()=>[R(r,{src:i.newCommentImage,mode:"aspectFill",class:"preview-img"},null,8,["src"]),R(n,{class:"remove-img-btn",onClick:o.removeCommentImage},{default:E((()=>[V("Ã—")])),_:1},8,["onClick"])])),_:1})):z("",!0),R(n,{class:"input-row"},{default:E((()=>[R(n,{class:"icon-btn",onClick:o.chooseCommentImage},{default:E((()=>[R(l,null,{default:E((()=>[V("ğŸ“·")])),_:1})])),_:1},8,["onClick"]),R(u,{class:"comment-input",placeholder:"å¯«ä¸‹ä½ çš„è©•è«–...",modelValue:i.newComment,"onUpdate:modelValue":e[2]||(e[2]=t=>i.newComment=t),"confirm-type":"send",onConfirm:o.addComment},null,8,["modelValue","onConfirm"]),R(m,{class:"send-btn",onClick:o.addComment},{default:E((()=>[V("ç™¼é€")])),_:1},8,["onClick"])])),_:1}),R(n,{class:"bottom-interactions"},{default:E((()=>[R(n,{class:"interaction-btn",onClick:o.toggleFavorite},{default:E((()=>[R(l,{class:"interaction-icon"},{default:E((()=>[V(O(i.isFavorited?"â˜…":"â˜†"),1)])),_:1}),R(l,{class:"interaction-text"},{default:E((()=>[V("æ”¶è—")])),_:1})])),_:1},8,["onClick"]),R(n,{class:"interaction-btn",onClick:o.toggleLike},{default:E((()=>[R(l,{class:"interaction-icon"},{default:E((()=>[V(O(i.isLiked?"â¤ï¸":"ğŸ¤"),1)])),_:1}),R(l,{class:"interaction-text"},{default:E((()=>[V("è®šå¥½")])),_:1})])),_:1},8,["onClick"]),R(n,{class:"interaction-btn",onClick:o.sharePost},{default:E((()=>[R(l,{class:"interaction-icon"},{default:E((()=>[V("ğŸ“¤")])),_:1}),R(l,{class:"interaction-text"},{default:E((()=>[V("åˆ†äº«")])),_:1})])),_:1},8,["onClick"]),R(n,{class:"interaction-btn",onClick:e[3]||(e[3]=t=>o.scrollToComments(i.post.authorName))},{default:E((()=>[R(l,{class:"interaction-icon"},{default:E((()=>[V("ğŸ’¬")])),_:1}),R(l,{class:"interaction-text"},{default:E((()=>[V("å›å¾©")])),_:1})])),_:1})])),_:1})])),_:1}),i.showBidModal?(q(),U(n,{key:1,class:"modal-mask",onClick:o.closeBidModal},{default:E((()=>[R(n,{class:"modal-content",onClick:e[5]||(e[5]=K((()=>{}),["stop"]))},{default:E((()=>[R(n,{class:"modal-header"},{default:E((()=>[R(l,{class:"modal-title"},{default:E((()=>[V("åƒèˆ‡æ‹è³£ ğŸ”¨")])),_:1})])),_:1}),R(n,{class:"modal-body"},{default:E((()=>[R(l,{class:"current-bid-info"},{default:E((()=>[V("ç•¶å‰æœ€é«˜åƒ¹: "),R(l,{class:"highlight-price"},{default:E((()=>[V("$"+O(i.currentPrice),1)])),_:1})])),_:1}),R(n,{class:"input-wrapper"},{default:E((()=>[R(l,{class:"currency-symbol"},{default:E((()=>[V("$")])),_:1}),R(u,{class:"bid-input",type:"number",modelValue:i.bidPrice,"onUpdate:modelValue":e[4]||(e[4]=t=>i.bidPrice=t),placeholder:"è¼¸å…¥æ‚¨çš„å‡ºåƒ¹",focus:""},null,8,["modelValue"])])),_:1}),R(l,{class:"bid-hint"},{default:E((()=>[V("å‡ºåƒ¹å¿…é ˆé«˜æ–¼ $"+O(i.currentPrice),1)])),_:1})])),_:1}),R(n,{class:"modal-footer"},{default:E((()=>[R(m,{class:"modal-btn cancel",onClick:o.closeBidModal},{default:E((()=>[V("å–æ¶ˆ")])),_:1},8,["onClick"]),R(m,{class:"modal-btn confirm",onClick:o.confirmBid},{default:E((()=>[V("ç¢ºå®šå‡ºåƒ¹")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):z("",!0),i.showTimerModal?(q(),U(n,{key:2,class:"modal-mask",onClick:o.closeTimerModal},{default:E((()=>[R(n,{class:"modal-content",onClick:e[11]||(e[11]=K((()=>{}),["stop"]))},{default:E((()=>[R(n,{class:"modal-header"},{default:E((()=>[R(l,{class:"modal-title"},{default:E((()=>[V("è¨­å®šå€’æ•¸æ™‚é–“ â±ï¸")])),_:1})])),_:1}),R(n,{class:"modal-body"},{default:E((()=>[R(l,{class:"timer-hint"},{default:E((()=>[V("è«‹è¼¸å…¥å€’æ•¸åˆ†é˜æ•¸ (ä¾‹å¦‚: 5)")])),_:1}),R(n,{class:"input-wrapper"},{default:E((()=>[R(u,{class:"bid-input",type:"number",modelValue:i.timerMinutes,"onUpdate:modelValue":e[6]||(e[6]=t=>i.timerMinutes=t),placeholder:"åˆ†é˜",focus:""},null,8,["modelValue"]),R(l,{class:"currency-symbol",style:{"font-size":"14px","margin-left":"10px"}},{default:E((()=>[V("åˆ†é˜")])),_:1})])),_:1}),R(n,{class:"quick-select"},{default:E((()=>[R(n,{class:"quick-btn",onClick:e[7]||(e[7]=t=>i.timerMinutes="5")},{default:E((()=>[V("5åˆ†é˜")])),_:1}),R(n,{class:"quick-btn",onClick:e[8]||(e[8]=t=>i.timerMinutes="10")},{default:E((()=>[V("10åˆ†é˜")])),_:1}),R(n,{class:"quick-btn",onClick:e[9]||(e[9]=t=>i.timerMinutes="30")},{default:E((()=>[V("30åˆ†é˜")])),_:1}),R(n,{class:"quick-btn",onClick:e[10]||(e[10]=t=>i.timerMinutes="60")},{default:E((()=>[V("1å°æ™‚")])),_:1})])),_:1})])),_:1}),R(n,{class:"modal-footer"},{default:E((()=>[R(m,{class:"modal-btn cancel",onClick:o.closeTimerModal},{default:E((()=>[V("å–æ¶ˆ")])),_:1},8,["onClick"]),R(m,{class:"modal-btn confirm",onClick:o.confirmStartTimer},{default:E((()=>[V("å•Ÿå‹•å€’æ•¸")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):z("",!0),i.showBidHistoryModal?(q(),U(n,{key:3,class:"modal-mask",onClick:o.closeBidHistoryModal},{default:E((()=>[R(n,{class:"modal-content history-modal",onClick:e[12]||(e[12]=K((()=>{}),["stop"]))},{default:E((()=>[R(n,{class:"modal-header"},{default:E((()=>[R(l,{class:"modal-title"},{default:E((()=>[V("è©³ç´°å‡ºåƒ¹ç´€éŒ„ ğŸ“œ")])),_:1}),R(n,{class:"close-icon",onClick:o.closeBidHistoryModal},{default:E((()=>[V("Ã—")])),_:1},8,["onClick"])])),_:1}),R(h,{"scroll-y":"true",class:"history-list-scroll"},{default:E((()=>[R(n,{class:"full-history-list"},{default:E((()=>[R(n,{class:"history-row header"},{default:E((()=>[R(l,{class:"col-user"},{default:E((()=>[V("ç”¨æˆ¶")])),_:1}),R(l,{class:"col-price"},{default:E((()=>[V("å‡ºåƒ¹")])),_:1}),R(l,{class:"col-time"},{default:E((()=>[V("æ™‚é–“")])),_:1})])),_:1}),(q(!0),j(G,null,W(i.bidHistory,((t,e)=>(q(),U(n,{class:J(["history-row",{"top-bid":0===e}]),key:e},{default:E((()=>[R(n,{class:"col-user user-flex"},{default:E((()=>[R(r,{src:t.avatar||"/static/logo.png",class:"history-avatar",mode:"aspectFill"},null,8,["src"]),R(l,{class:"history-name"},{default:E((()=>[V(O(t.userName),1)])),_:2},1024),0===e?(q(),U(l,{key:0,class:"crown"},{default:E((()=>[V("ğŸ‘‘")])),_:1})):z("",!0)])),_:2},1024),R(l,{class:"col-price price-bold"},{default:E((()=>[V("$"+O(t.price),1)])),_:2},1024),R(l,{class:"col-time time-detail"},{default:E((()=>[V(O(o.formatDateFull(t.timestamp)),1)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["onClick"])):z("",!0),R(f)])),_:1})}],["__scopeId","data-v-6b03a141"]]);export{lt as default};

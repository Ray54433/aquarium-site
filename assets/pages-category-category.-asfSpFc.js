import{C as t,R as e,k as s,g as a,N as l,j as i,O as o,p as n,n as r,P as c,t as u,aI as d,T as f,aJ as g,aK as h,aL as m,aM as y,m as _,q as p,U as b,at as k,aN as A,aD as C,r as I,y as F,z as v,A as M,s as w,v as S,B as D,D as N,c as P,w as $,i as E,o as T,a as B,b as U,J as R,H as x,E as L,F as V,G as K,L as q,e as H,d as j,a6 as J,I as O,aj as G,S as z,K as Q}from"./index-CcRA1RUw.js";import{r as W,_ as X}from"./uni-app.es.2SZY3XeM.js";import{_ as Y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const Z=Y({data:()=>({posts:[],categoryId:"",subCategoryId:"",detailCategoryId:"",searchKeyword:"",myFavorites:[],isAuctionMode:!1,currentAuctionFilter:"all",currentSubAuctionFilter:"all",currentDetailAuctionFilter:"all",contactName:"",contactEmail:"",contactMessage:"",isMod:!1,showBusinessAdmin:!1,businessMessages:[],timerInterval:null}),computed:{currentModerators(){if(!this.categoryId||"business"===this.categoryId||"brands"===this.categoryId)return[];const e=t.find((t=>t.id===this.categoryId));return e&&e.moderators||[]},canHaveAuction(){return["saltwater","freshwater","plants","crystal_shrimp"].includes(this.categoryId)},currentSubCategories(){if("all"===this.currentAuctionFilter)return[];const e=t.find((t=>t.id===this.currentAuctionFilter));return e&&e.children?e.children:[]},currentDetailCategories(){if("all"===this.currentSubAuctionFilter)return[];const t=this.currentSubCategories;if(!t)return[];const e=t.find((t=>t.id===this.currentSubAuctionFilter));return e&&e.children?e.children:[]},displayPosts(){if(!this.isAuctionMode)return this.posts;let t=this.posts;return"all"!==this.currentAuctionFilter&&(t=t.filter((t=>t.categoryId===this.currentAuctionFilter))),"all"!==this.currentSubAuctionFilter&&(t=t.filter((t=>t.subCategoryId===this.currentSubAuctionFilter))),"all"!==this.currentDetailAuctionFilter&&(t=t.filter((t=>t.detailCategoryId===this.currentDetailAuctionFilter))),t}},onLoad(t){t.title&&e({title:t.title}),t.search?this.searchKeyword=t.search:"auction"===t.type?(this.isAuctionMode=!0,t.filter&&(this.currentAuctionFilter=t.filter)):(this.categoryId=t.categoryId,this.subCategoryId=t.subCategoryId,this.detailCategoryId=t.detailCategoryId)},onShow(){this.refreshRole(),this.loadPosts(),this.loadFavorites(),this.startListTimer()},onHide(){this.timerInterval&&clearInterval(this.timerInterval)},async onPullDownRefresh(){try{await s()&&this.loadPosts()}catch(t){console.error("Category refresh error:",t)}finally{setTimeout((()=>{a()}),500)}},methods:{async togglePin(t){const e=!t.isPinned,s=e?"ç½®é ‚":"å–æ¶ˆç½®é ‚";l({title:"ç®¡ç†å“¡æ“ä½œ",content:`ç¢ºå®šè¦${s}æ­¤å¸–å­å—Žï¼Ÿ`,success:async a=>{if(a.confirm)try{i({title:"è™•ç†ä¸­..."}),await o(t.id,{isPinned:e}),t.isPinned=e,this.loadPosts(),n(),r({title:`å·²${s}`})}catch(l){console.error("Pin error:",l),n(),r({title:"æ“ä½œå¤±æ•—",icon:"none"})}}})},refreshRole(){this.checkUserRole(),c().then((()=>{this.checkUserRole()}))},checkUserRole(){const t=u();this.isMod=d(t,this.categoryId),console.log("--- DEBUG ROLE CHECK ---"),console.log("Category:",this.categoryId),console.log("User:",t?t.name:"No User"),console.log("isSystemAdmin:",f(t));const e=g(this.categoryId);console.log("Category Mods:",e?e.moderators:"None"),console.log("Result isMod:",this.isMod),console.log("------------------------")},loadPosts(){this.isAuctionMode?this.posts=h():this.searchKeyword?this.posts=m(this.searchKeyword):this.posts=y(this.categoryId,this.subCategoryId),this.posts.sort(((t,e)=>t.isPinned&&!e.isPinned?-1:!t.isPinned&&e.isPinned?1:(e.timestamp||0)-(t.timestamp||0)));const t=this.posts.filter((t=>"auction"===t.type));t.length>0&&t.forEach((async t=>{try{const{data:e}=await _(t.id);if(e&&e.length>0){let s=parseFloat(t.price)||0;e.forEach((t=>{let e=0;const a=t.text.trim();if(a.includes("å‡ºåƒ¹")){const t=a.match(/(\d+)/);t&&(e=parseFloat(t[1]))}e>s&&(s=e)})),t.price=s}}catch(e){console.error("Fetch auction price error:",e)}}))},setAuctionFilter(t){this.currentAuctionFilter=t,this.currentSubAuctionFilter="all",this.currentDetailAuctionFilter="all"},setSubAuctionFilter(t){this.currentSubAuctionFilter=t,this.currentDetailAuctionFilter="all"},setDetailAuctionFilter(t){this.currentDetailAuctionFilter=t},goToAuctions(){p({url:`/pages/category/category?type=auction&title=æ‹è³£å€&filter=${this.categoryId}`})},goToDetail(t){p({url:`/pages/detail/detail?id=${t}`})},createPost(){if(!u())return r({title:"è«‹å…ˆç™»å…¥",icon:"none"}),void setTimeout((()=>{p({url:"/pages/login/login"})}),1e3);b("preSelectCategory",{categoryId:this.categoryId,subCategoryId:this.subCategoryId,detailCategoryId:this.detailCategoryId});let t="/pages/create/create";this.isAuctionMode&&(t+="?type=auction","all"!==this.currentAuctionFilter&&(t+=`&categoryId=${this.currentAuctionFilter}`),"all"!==this.currentSubAuctionFilter&&(t+=`&subCategoryId=${this.currentSubAuctionFilter}`),"all"!==this.currentDetailAuctionFilter&&(t+=`&detailCategoryId=${this.currentDetailAuctionFilter}`)),p({url:t})},formatDate(t){if(!t)return"";const e=new Date(t);return`${e.getMonth()+1}/${e.getDate()} ${e.getHours()}:${e.getMinutes()}`},getCategoryName(e){if(!e.categoryId)return"";if(!t||!Array.isArray(t))return"";const s=t.find((t=>t.id===e.categoryId));if(s){let t=s.name;if(e.subCategoryId&&s.children){const a=s.children.find((t=>t.id===e.subCategoryId));if(a&&(t+=` > ${a.name}`,e.detailCategoryId&&a.children)){const s=a.children.find((t=>t.id===e.detailCategoryId));s&&(t+=` > ${s.name}`)}}return t}return""},async submitInquiry(){if(!this.contactName||!this.contactEmail||!this.contactMessage)return void r({title:"è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½",icon:"none"});const t=u();if(!t||!t.id||"guest"===t.id)return r({title:"è«‹å…ˆç™»å…¥ä»¥æäº¤ç•™è¨€",icon:"none"}),void setTimeout((()=>{p({url:"/pages/login/login"})}),1500);i({title:"ç™¼é€ä¸­..."});try{const e={title:`ã€å•†æ¥­åˆä½œã€‘ä¾†è‡ª ${this.contactName}`,content:`è¯çµ¡äºº: ${this.contactName}\né›»éƒµ: ${this.contactEmail}\n\nåˆä½œå…§å®¹:\n${this.contactMessage}`,authorId:t.id,authorName:t.name||this.contactName,categoryId:"business_inquiry",subCategoryId:"",detailCategoryId:"",type:"normal",price:"",images:JSON.stringify([]),timestamp:Math.floor(Date.now()/1e3),likes:JSON.stringify([]),comments:JSON.stringify([])},{data:s,error:a}=await k(e);if(a)throw a;n(),r({title:"ç™¼é€æˆåŠŸï¼",icon:"success"}),this.contactName="",this.contactEmail="",this.contactMessage=""}catch(e){console.error("Submit inquiry failed:",e),n();let t="ç™¼é€å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦";e.message&&e.message.includes("Unknown attribute")&&(t="ç³»çµ±é…ç½®éŒ¯èª¤ (å­—æ®µç¼ºå¤±)ï¼Œè«‹è¯ç¹«ç®¡ç†å“¡"),r({title:t,icon:"none"})}},toggleBusinessAdmin(){this.showBusinessAdmin=!this.showBusinessAdmin,this.showBusinessAdmin&&this.loadBusinessMessages()},async loadBusinessMessages(){i({title:"åŠ è¼‰ç•™è¨€ä¸­..."});try{const{data:t,error:e}=await A();if(e)throw e;this.businessMessages=t.filter((t=>"business_inquiry"===t.categoryId))}catch(t){console.error("Load business messages failed:",t),r({title:"åŠ è¼‰å¤±æ•—",icon:"none"})}finally{n()}},async deleteMessage(t,e){l({title:"ç¢ºèªåˆªé™¤",content:"ç¢ºå®šè¦åˆªé™¤é€™æ¢ç•™è¨€å—Žï¼Ÿ",success:async s=>{if(s.confirm){if(i({title:"åˆªé™¤ä¸­..."}),t.$id)try{const{error:e}=await C(t.$id);if(e)throw e}catch(a){return console.error("Delete message failed:",a),n(),void r({title:"åˆªé™¤å¤±æ•—",icon:"none"})}this.businessMessages.splice(e,1),n(),r({title:"å·²åˆªé™¤",icon:"success"})}}})},goToBusiness(){p({url:"/pages/category/category?categoryId=business&title=å•†æ¥­åˆä½œ"})},getLevel(t){let e=t.authorId;if(!e&&t.authorName){const s=I(t.authorName);s&&(e=s.id)}return F(e)},getPoints(t){let e=t.authorId;if(!e&&t.authorName){const s=I(t.authorName);s&&(e=s.id)}return v(e)},getAvatar(t){let e=t.authorId;if(!e&&t.authorName){const s=I(t.authorName);s&&(e=s.id)}if(e){const t=M(e);if(t)return t}return t.authorAvatar?t.authorAvatar:""},goToUserProfile(t){let e=t.authorId;if(!e&&t.authorName){const s=I(t.authorName);s&&(e=s.id)}if(e){const t=u();t&&String(t.id)===String(e)?w({url:"/pages/profile/profile"}):p({url:`/pages/profile/public_profile?userId=${e}`})}},getRole:t=>S(t.authorName),startListTimer(){this.timerInterval&&clearInterval(this.timerInterval),this.timerInterval=setInterval((()=>{this.$forceUpdate()}),1e3)},isAuctionEnded(t){if(!t.auctionEndTime)return!1;return Math.floor(Date.now()/1e3)>=parseInt(t.auctionEndTime)},getCountdown(t){if(!t.auctionEndTime)return"";let e=parseInt(t.auctionEndTime)-Math.floor(Date.now()/1e3);if(e<=0)return"00:00:00";const s=Math.floor(e/3600),a=Math.floor(e%3600/60),l=e%60;return`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},loadFavorites(){const t=u();this.myFavorites=t&&D(`favorites_${t.id}`)||[]},isFavorited(t){return this.myFavorites.includes(t)}}},[["render",function(t,e,s,a,l,i){const o=H,n=E,r=j,c=J,u=O,d=G,f=z,g=W(N("app-tab-bar"),X);return T(),P(n,{class:"container"},{default:$((()=>[l.isAuctionMode?(T(),P(n,{key:0,class:"notice-bar"},{default:$((()=>[B(n,{class:"notice-content"},{default:$((()=>[B(o,{class:"notice-text"},{default:$((()=>[U("ðŸ“¢ æ‹è³£ç‰ˆè¦ï¼š1. åš´ç¦ç™¼ä½ˆè™›å‡å•†å“ã€‚ 2. ç¦æ­¢å”®è³£å—ä¿è­·ç€•å±ç‰©ç¨®ã€‚ 3. è²·è³£é›™æ–¹è«‹è‡ªè¡Œæ‰¿æ“”é¢¨éšªï¼Œæœ¬å¹³å°ä¸ä»‹å…¥ç³¾ç´›ã€‚ 4. åš´ç¦æ£„æ¨™ï¼Œé•è€…å°‡è¢«åˆ—å…¥é»‘åå–®ã€‚ 5. è«‹æ¨™æ˜Žæ¸…æ¥šåƒ¹éŒ¢åŠäº¤æ”¶åœ°é»žã€‚ âš ï¸")])),_:1})])),_:1})])),_:1})):(T(),P(n,{key:1,class:"notice-bar"},{default:$((()=>[B(n,{class:"notice-content"},{default:$((()=>[B(o,{class:"notice-text"},{default:$((()=>[U("ðŸ“¢ æœ¬ç‰ˆç‰ˆè¦ï¼šåš´ç¦ç™¼ä½ˆä»»ä½•è‰²æƒ…ã€æš´åŠ›ã€è³­åšåŠè©é¨™è¨Šæ¯ã€‚è«‹ä¿æŒç¦®è²Œï¼Œå°Šé‡ä»–äººã€‚é•è€…å°‡è¢«å°ç¦ã€‚")])),_:1})])),_:1})])),_:1})),"business"===l.categoryId?(T(),P(n,{key:2,class:"business-view"},{default:$((()=>[B(n,{class:"business-header"},{default:$((()=>[B(r,{src:"./static/category/handshake.png",class:"business-icon",mode:"aspectFit"}),B(o,{class:"business-title"},{default:$((()=>[U("å•†æ¥­åˆä½œ")])),_:1}),B(o,{class:"business-desc"},{default:$((()=>[U("å¦‚æœ‰ä»»ä½•å•†æ¥­åˆä½œæ„å‘ï¼Œæ­¡è¿Žç•™è¨€è¯ç¹«æˆ‘å€‘ã€‚")])),_:1})])),_:1}),l.isMod?(T(),P(n,{key:0,class:"admin-action-area"},{default:$((()=>[B(c,{class:"admin-view-btn",onClick:i.toggleBusinessAdmin},{default:$((()=>[U(R(l.showBusinessAdmin?"è¿”å›žç•™è¨€è¡¨å–®":"æŸ¥çœ‹æ‰€æœ‰ç•™è¨€ (ç®¡ç†å“¡)"),1)])),_:1},8,["onClick"])])),_:1})):x("",!0),l.showBusinessAdmin&&l.isMod?(T(),P(n,{key:1,class:"business-message-list"},{default:$((()=>[(T(!0),L(K,null,V(l.businessMessages,((t,e)=>(T(),P(n,{class:"message-card",key:e},{default:$((()=>[B(n,{class:"message-header"},{default:$((()=>[B(o,{class:"message-sender"},{default:$((()=>[U(R(t.authorName||"åŒ¿å"),1)])),_:2},1024),B(n,{class:"message-actions"},{default:$((()=>[B(o,{class:"message-time"},{default:$((()=>[U(R(i.formatDate(1e3*t.timestamp)),1)])),_:2},1024),B(o,{class:"delete-icon",onClick:Q((s=>i.deleteMessage(t,e)),["stop"])},{default:$((()=>[U("ðŸ—‘ï¸")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),B(o,{class:"message-email"},{default:$((()=>[U(R(t.title),1)])),_:2},1024),B(n,{class:"message-content-box"},{default:$((()=>[B(o,{class:"message-content"},{default:$((()=>[U(R(t.content),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),0===l.businessMessages.length?(T(),P(n,{key:0,class:"empty-state"},{default:$((()=>[B(o,null,{default:$((()=>[U("æš«ç„¡å•†æ¥­ç•™è¨€")])),_:1})])),_:1})):x("",!0)])),_:1})):(T(),P(n,{key:2,class:"contact-form"},{default:$((()=>[B(n,{class:"form-group"},{default:$((()=>[B(o,{class:"label"},{default:$((()=>[U("è¯çµ¡äºº/å…¬å¸åç¨±")])),_:1}),B(u,{class:"input",modelValue:l.contactName,"onUpdate:modelValue":e[0]||(e[0]=t=>l.contactName=t),placeholder:"è«‹è¼¸å…¥åç¨±"},null,8,["modelValue"])])),_:1}),B(n,{class:"form-group"},{default:$((()=>[B(o,{class:"label"},{default:$((()=>[U("è¯çµ¡é›»éƒµ")])),_:1}),B(u,{class:"input",modelValue:l.contactEmail,"onUpdate:modelValue":e[1]||(e[1]=t=>l.contactEmail=t),placeholder:"è«‹è¼¸å…¥é›»éƒµ"},null,8,["modelValue"])])),_:1}),B(n,{class:"form-group"},{default:$((()=>[B(o,{class:"label"},{default:$((()=>[U("åˆä½œå…§å®¹")])),_:1}),B(d,{class:"textarea",modelValue:l.contactMessage,"onUpdate:modelValue":e[2]||(e[2]=t=>l.contactMessage=t),placeholder:"è«‹æè¿°æ‚¨çš„åˆä½œæ„å‘..."},null,8,["modelValue"])])),_:1}),B(c,{class:"submit-btn",onClick:i.submitInquiry},{default:$((()=>[U("ç™¼é€ç•™è¨€")])),_:1},8,["onClick"])])),_:1}))])),_:1})):"brands"===l.categoryId?(T(),P(n,{key:3,class:"brands-view"},{default:$((()=>[B(n,{class:"brands-header"},{default:$((()=>[B(r,{src:"https://cdn-icons-png.flaticon.com/512/1152/1152912.png",class:"brands-icon",mode:"aspectFit"}),B(o,{class:"brands-title"},{default:$((()=>[U("å“ç‰Œå°ˆå€")])),_:1}),B(o,{class:"brands-desc"},{default:$((()=>[U("æŽ¨è–¦å„ªè³ªæ°´æ—å“ç‰Œèˆ‡ç”¢å“")])),_:1})])),_:1}),B(n,{class:"ad-list"},{default:$((()=>[(T(!0),L(K,null,V(l.posts,(t=>(T(),P(n,{class:"ad-card",key:t.id,onClick:e=>i.goToDetail(t.id)},{default:$((()=>[B(r,{src:t.images&&t.images.length>0?t.images[0]:t.image||"/static/logo.png",mode:"aspectFill",class:"ad-image"},null,8,["src"]),B(n,{class:"ad-content"},{default:$((()=>[B(o,{class:"ad-title"},{default:$((()=>[U(R(t.title),1)])),_:2},1024),B(o,{class:"ad-desc"},{default:$((()=>[U(R(t.content),1)])),_:2},1024),B(c,{class:"ad-btn"},{default:$((()=>[U("æŸ¥çœ‹è©³æƒ…")])),_:1})])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0===l.posts.length?(T(),P(n,{key:0,class:"empty-state"},{default:$((()=>[B(o,null,{default:$((()=>[U("æš«ç„¡å“ç‰ŒæŽ¨è–¦")])),_:1})])),_:1})):x("",!0)])),_:1}),l.isMod?x("",!0):(T(),P(n,{key:0,class:"advertise-cta"},{default:$((()=>[B(o,{class:"cta-text"},{default:$((()=>[U("æƒ³åœ¨é€™è£¡å±•ç¤ºæ‚¨çš„å“ç‰Œï¼Ÿ")])),_:1}),B(c,{class:"cta-btn",onClick:i.goToBusiness},{default:$((()=>[U("è¯ç¹«å•†æ¥­åˆä½œ")])),_:1},8,["onClick"])])),_:1})),l.isMod?(T(),P(n,{key:1,class:"fab",onClick:i.createPost},{default:$((()=>[B(o,{class:"fab-icon"},{default:$((()=>[U("+")])),_:1})])),_:1},8,["onClick"])):x("",!0)])),_:1})):(T(),L(K,{key:4},[i.currentModerators&&i.currentModerators.length>0&&!l.isAuctionMode?(T(),P(n,{key:0,class:"moderator-header"},{default:$((()=>[B(o,{class:"mod-label"},{default:$((()=>[U("ç‰ˆä¸»ï¼š")])),_:1}),B(n,{class:"mod-list"},{default:$((()=>[(T(!0),L(K,null,V(i.currentModerators,((t,e)=>(T(),P(n,{key:e,class:"mod-badge"},{default:$((()=>[B(o,null,{default:$((()=>[U(R(t),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})):x("",!0),l.isAuctionMode?(T(),P(n,{key:1,class:"auction-tabs"},{default:$((()=>[B(f,{"scroll-x":"true",class:"tabs-scroll"},{default:$((()=>[B(n,{class:"tabs-container"},{default:$((()=>[B(n,{class:q(["tab-item",{active:"all"===l.currentAuctionFilter}]),onClick:e[3]||(e[3]=t=>i.setAuctionFilter("all"))},{default:$((()=>[B(o,null,{default:$((()=>[U("å…¨éƒ¨")])),_:1})])),_:1},8,["class"]),(T(),L(K,null,V(["saltwater","freshwater","plants","crystal_shrimp"],(t=>B(n,{class:q(["tab-item",{active:l.currentAuctionFilter===t}]),key:t,onClick:e=>i.setAuctionFilter(t)},{default:$((()=>[B(o,null,{default:$((()=>[U(R("saltwater"===t?"å’¸æ°´å€":"freshwater"===t?"æ·¡æ°´å€":"plants"===t?"æ°´è‰å€":"æ°´æ™¶è¦å€"),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))),64))])),_:1})])),_:1}),i.currentSubCategories.length>0?(T(),P(f,{key:0,"scroll-x":"true",class:"tabs-scroll sub-tabs"},{default:$((()=>[B(n,{class:"tabs-container"},{default:$((()=>[B(n,{class:q(["tab-item sub-tab",{active:"all"===l.currentSubAuctionFilter}]),onClick:e[4]||(e[4]=t=>i.setSubAuctionFilter("all"))},{default:$((()=>[B(o,null,{default:$((()=>[U("å…¨éƒ¨")])),_:1})])),_:1},8,["class"]),(T(!0),L(K,null,V(i.currentSubCategories,(t=>(T(),P(n,{class:q(["tab-item sub-tab",{active:l.currentSubAuctionFilter===t.id}]),key:t.id,onClick:e=>i.setSubAuctionFilter(t.id)},{default:$((()=>[B(o,null,{default:$((()=>[U(R(t.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):x("",!0),i.currentDetailCategories.length>0?(T(),P(f,{key:1,"scroll-x":"true",class:"tabs-scroll detail-tabs"},{default:$((()=>[B(n,{class:"tabs-container"},{default:$((()=>[B(n,{class:q(["tab-item detail-tab",{active:"all"===l.currentDetailAuctionFilter}]),onClick:e[5]||(e[5]=t=>i.setDetailAuctionFilter("all"))},{default:$((()=>[B(o,null,{default:$((()=>[U("å…¨éƒ¨")])),_:1})])),_:1},8,["class"]),(T(!0),L(K,null,V(i.currentDetailCategories,(t=>(T(),P(n,{class:q(["tab-item detail-tab",{active:l.currentDetailAuctionFilter===t.id}]),key:t.id,onClick:e=>i.setDetailAuctionFilter(t.id)},{default:$((()=>[B(o,null,{default:$((()=>[U(R(t.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):x("",!0)])),_:1})):x("",!0),B(n,{class:q(["post-list",{"with-tabs":l.isAuctionMode}])},{default:$((()=>[!l.isAuctionMode&&i.canHaveAuction?(T(),P(n,{key:0,class:"view-auction-btn",onClick:i.goToAuctions},{default:$((()=>[B(o,null,{default:$((()=>[U("æŸ¥çœ‹æœ¬å€æ‹è³£ ðŸ”¨")])),_:1})])),_:1},8,["onClick"])):x("",!0),(T(!0),L(K,null,V(i.displayPosts,((t,e)=>(T(),P(n,{key:e,class:"post-card",onClick:e=>i.goToDetail(t.id)},{default:$((()=>[B(n,{class:"post-header"},{default:$((()=>[B(n,{class:"author-row"},{default:$((()=>[B(r,{src:i.getAvatar(t)||"/static/logo.png",class:"post-small-avatar",mode:"aspectFill",onClick:Q((e=>i.goToUserProfile(t)),["stop"])},null,8,["src","onClick"]),B(o,{class:"post-author"},{default:$((()=>[U(R(t.authorName),1)])),_:2},1024),i.getRole(t)?(T(),P(n,{key:0,class:q(["role-badge",i.getRole(t).type])},{default:$((()=>[B(o,null,{default:$((()=>[U(R(i.getRole(t).label),1)])),_:2},1024)])),_:2},1032,["class"])):x("",!0),B(n,{class:"user-stats"},{default:$((()=>[B(o,{class:"stat-badge level"},{default:$((()=>[U("Lv."+R(i.getLevel(t)),1)])),_:2},1024),B(o,{class:"stat-badge points"},{default:$((()=>[U("ðŸ”¥"+R(i.getPoints(t)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),B(n,{class:"header-right-actions"},{default:$((()=>[B(o,{class:"post-time"},{default:$((()=>[U(R(i.formatDate(t.timestamp)),1)])),_:2},1024),l.isMod?(T(),P(n,{key:0,class:"admin-pin-btn",onClick:Q((e=>i.togglePin(t)),["stop"])},{default:$((()=>[B(o,null,{default:$((()=>[U(R(t.isPinned?"å–æ¶ˆç½®é ‚":"ç½®é ‚"),1)])),_:2},1024)])),_:2},1032,["onClick"])):x("",!0)])),_:2},1024)])),_:2},1024),t.isPinned?(T(),P(n,{key:0,class:"pin-badge"},{default:$((()=>[B(o,null,{default:$((()=>[U("ðŸ“Œ ç½®é ‚")])),_:1})])),_:1})):x("",!0),"auction"===t.type?(T(),P(n,{key:1,class:"auction-badge"},{default:$((()=>[B(o,null,{default:$((()=>[U("ðŸ”¨ æ‹è³£ | èµ·æ‹åƒ¹ $"+R(t.price),1)])),_:2},1024),t.auctionEndTime&&!i.isAuctionEnded(t)?(T(),P(o,{key:0,class:"auction-countdown"},{default:$((()=>[U("â° "+R(i.getCountdown(t)),1)])),_:2},1024)):t.auctionEndTime&&i.isAuctionEnded(t)?(T(),P(o,{key:1,class:"auction-ended"},{default:$((()=>[U("ðŸ”´ å·²çµæŸ")])),_:1})):x("",!0)])),_:2},1024)):x("",!0),i.getCategoryName(t)?(T(),P(n,{key:2,class:"category-tag"},{default:$((()=>[B(o,null,{default:$((()=>[U("#"+R(i.getCategoryName(t)),1)])),_:2},1024)])),_:2},1024)):x("",!0),B(o,{class:"post-title"},{default:$((()=>[U(R(t.title),1)])),_:2},1024),B(o,{class:"post-summary"},{default:$((()=>[U(R(t.content.substring(0,50))+"...",1)])),_:2},1024),t.images&&t.images.length>0?(T(),P(n,{key:3,class:"image-preview-list"},{default:$((()=>[(T(!0),L(K,null,V(t.images.slice(0,3),((t,e)=>(T(),P(r,{key:e,src:t,mode:"aspectFill",class:"post-image-small"},null,8,["src"])))),128))])),_:2},1024)):t.image?(T(),P(r,{key:4,src:t.image,mode:"aspectFill",class:"post-image"},null,8,["src"])):x("",!0),B(n,{class:"card-footer"},{default:$((()=>[B(n,{class:"interaction-stat"},{default:$((()=>[B(o,{class:"stat-icon"},{default:$((()=>[U("â¤ï¸")])),_:1}),B(o,{class:"stat-count"},{default:$((()=>[U(R(t.likes&&t.likes.length||0),1)])),_:2},1024)])),_:2},1024),B(n,{class:"interaction-stat"},{default:$((()=>[B(o,{class:"stat-icon"},{default:$((()=>[U("ðŸ’¬")])),_:1}),B(o,{class:"stat-count"},{default:$((()=>[U(R(t.comments&&t.comments.length||0),1)])),_:2},1024)])),_:2},1024),i.isFavorited(t.id)?(T(),P(n,{key:0,class:"interaction-stat"},{default:$((()=>[B(o,{class:"stat-icon"},{default:$((()=>[U("â­")])),_:1}),B(o,{class:"stat-count"},{default:$((()=>[U("å·²æ”¶è—")])),_:1})])),_:1})):x("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0===i.displayPosts.length?(T(),P(n,{key:1,class:"empty-state"},{default:$((()=>[B(o,null,{default:$((()=>[U("æš«ç„¡ç›¸é—œå¸–å­")])),_:1})])),_:1})):x("",!0)])),_:1},8,["class"]),l.searchKeyword||"business"===l.categoryId||"brands"===l.categoryId?x("",!0):(T(),P(n,{key:2,class:"fab",onClick:i.createPost},{default:$((()=>[B(o,{class:"fab-icon"},{default:$((()=>[U("+")])),_:1})])),_:1},8,["onClick"]))],64)),B(g)])),_:1})}],["__scopeId","data-v-933f9f89"]]);export{Z as default};

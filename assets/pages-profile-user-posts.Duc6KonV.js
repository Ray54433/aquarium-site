import{Q as t,f as e,r as s,p as a,k as l,l as o,x as i,y as c,C as n,B as r,c as d,w as u,i as p,o as f,a as g,b as y,H as _,D as h,E as m,F as b,G as C,e as k,K as v}from"./index-1UdTh2kG.js";import{r as I,_ as w}from"./uni-app.es.D-AGfr41.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=D({data:()=>({posts:[],type:"discussion"}),onLoad(e){e.type&&(this.type=e.type),t({title:"auction"===this.type?"æˆ‘çš„æ‹è³£":"æˆ‘çš„å¸–å­"})},onShow(){this.loadPosts()},onPullDownRefresh(){this.loadPosts(),setTimeout((()=>{e()}),1e3)},methods:{async loadPosts(){const t=s();if(!t)return void a({url:"/pages/login/login"});const e=l();this.posts=e.filter((e=>String(e.authorId)===String(t.id)&&("auction"===this.type?"auction"===e.type:"auction"!==e.type))),this.posts.sort(((t,e)=>e.timestamp-t.timestamp)),"auction"===this.type&&this.posts.forEach((async t=>{try{const{data:e}=await o(t.id);if(e&&e.length>0){let s=parseFloat(t.price)||0;e.forEach((t=>{let e=0;const a=t.text.trim();if(a.includes("å‡ºåƒ¹")){const t=a.match(/(\d+)/);t&&(e=parseFloat(t[1]))}e>s&&(s=e)})),t.price=s}}catch(e){console.error("Fetch my auction price error:",e)}}))},goToDetail(t){a({url:`/pages/detail/detail?id=${t}`})},formatDate(t){if(!t)return"";const e=new Date(t);return`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`},getLevel(){const t=s();return t?i(t.id):1},getPoints(){const t=s();return t?c(t.id):0},getCategoryName(t){if("circle"===t.categoryId)return"å¹æ°´å»£å ´"+(t.subCategoryId?" > "+t.subCategoryId:"");if(t.categoryId){const e=n.find((e=>e.id===t.categoryId));if(e){let s=e.name;if(t.subCategoryId&&e.children){const a=e.children.find((e=>e.id===t.subCategoryId));a&&(s+=` > ${a.name}`)}return s}}return""}}},[["render",function(t,e,s,a,l,o){const i=k,c=p,n=I(r("app-tab-bar"),w);return f(),d(c,{class:"container"},{default:u((()=>[g(c,{class:"notice-bar"},{default:u((()=>[g(c,{class:"notice-content"},{default:u((()=>[g(i,{class:"notice-text"},{default:u((()=>[y("ğŸ“¢ æœ¬ç‰ˆç‰ˆè¦ï¼šåš´ç¦ç™¼ä½ˆä»»ä½•è‰²æƒ…ã€æš´åŠ›ã€è³­åšåŠè©é¨™è¨Šæ¯ã€‚è«‹ä¿æŒç¦®è²Œï¼Œå°Šé‡ä»–äººã€‚é•è€…å°‡è¢«å°ç¦ã€‚")])),_:1})])),_:1})])),_:1}),g(c,{class:"header"},{default:u((()=>[g(i,null,{default:u((()=>[y(_("auction"===l.type?"æˆ‘çš„æ‹è³£":"æˆ‘çš„å¸–å­"),1)])),_:1})])),_:1}),g(c,{class:"post-list"},{default:u((()=>[(f(!0),h(b,null,m(l.posts,((t,e)=>(f(),d(c,{key:e,class:"post-card",onClick:e=>o.goToDetail(t.id)},{default:u((()=>[g(c,{class:"post-header"},{default:u((()=>[g(c,{class:"header-left"},{default:u((()=>[g(i,{class:"post-time"},{default:u((()=>[y(_(o.formatDate(t.timestamp)),1)])),_:2},1024),g(c,{class:"user-stats"},{default:u((()=>[g(i,{class:"stat-badge level"},{default:u((()=>[y("Lv."+_(o.getLevel()),1)])),_:1}),g(i,{class:"stat-badge points"},{default:u((()=>[y("ğŸ”¥"+_(o.getPoints()),1)])),_:1})])),_:1})])),_:2},1024),g(c,{class:"header-right"},{default:u((()=>[t.price?(f(),d(c,{key:0,class:"price-badge"},{default:u((()=>[g(i,null,{default:u((()=>[y(_("wtb"===t.type?"é ç®—":"wts"===t.type||"auction"===t.type?"å”®":"")+" $"+_(t.price),1)])),_:2},1024)])),_:2},1024)):C("",!0),g(i,{class:v(["status-tag","closed"===t.status?"closed":"active"])},{default:u((()=>[y(_("closed"===t.status?"å·²çµæŸ":"é€²è¡Œä¸­"),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),g(i,{class:"post-title"},{default:u((()=>[y(_(t.title),1)])),_:2},1024),o.getCategoryName(t)?(f(),d(c,{key:0,class:"category-tag"},{default:u((()=>[g(i,null,{default:u((()=>[y("#"+_(o.getCategoryName(t)),1)])),_:2},1024)])),_:2},1024)):C("",!0),g(c,{class:"post-stats"},{default:u((()=>[g(i,null,{default:u((()=>[y("ğŸ‘€ "+_(t.views||0),1)])),_:2},1024),g(i,null,{default:u((()=>[y("ğŸ’¬ "+_(t.comments?t.comments.length:0),1)])),_:2},1024),g(i,null,{default:u((()=>[y("â¤ï¸ "+_(t.likes?t.likes.length:0),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0===l.posts.length?(f(),d(c,{key:0,class:"empty-state"},{default:u((()=>[g(i,null,{default:u((()=>[y(_("auction"===l.type?"æš«ç„¡æ‹è³£è¨˜éŒ„":"æš«ç„¡å¸–å­è¨˜éŒ„"),1)])),_:1})])),_:1})):C("",!0)])),_:1}),g(n)])),_:1})}],["__scopeId","data-v-7447a464"]]);export{x as default};

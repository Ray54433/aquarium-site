import{t as e,u as s,a7 as t,a8 as a,U as l,q as i,B as n,l as o,C as c,a9 as u,n as r,s as d,N as f,aa as m,ab as g,c as h,w as _,i as p,o as y,a as v,b as k,J as C,H as b,L as I,E as M,F as w,G as S,e as U,d as N,S as x}from"./index-DeSSVyR4.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=P({data:()=>({user:{},myPosts:[],points:0,isSignedToday:!1,isMe:!0,targetUserId:"",isAdmin:!1,isMod:!1}),onLoad(t){if(t.userId){const s=e();s&&String(s.id)===String(t.userId)?this.isMe=!0:(this.isMe=!1,this.targetUserId=t.userId,t.name&&(this.user={id:t.userId,name:decodeURIComponent(t.name),avatar:t.avatar?decodeURIComponent(t.avatar):""}))}else this.isMe=!0;this.loadData(),this.isMe&&s()},onShow(){this.isMe&&(this.loadData(),s())},computed:{level(){return Math.floor(this.points/100)+1},levelTitle(){return this.level>=20?"å‚³èªªç´šé­šå‹":this.level>=10?"è³‡æ·±é­šå‹":this.level>=5?"é€²éšŽé­šå‹":"æ–°æ‰‹é­šå‹"}},onUnload(){this.isMe&&t("userProfileUpdated")},methods:{async loadData(){var s,t,u;if(this.isMe){let o=e();try{const e=await a();if(e){o={...o||{},id:e.$id,name:e.name,email:e.email,avatar:(null==(s=e.prefs)?void 0:s.avatar)||(null==o?void 0:o.avatar)||"",bio:(null==(t=e.prefs)?void 0:t.bio)||(null==o?void 0:o.bio)||"",signature:(null==(u=e.prefs)?void 0:u.signature)||(null==o?void 0:o.signature)||""},l("currentUser",o)}}catch(f){console.log("Sync failed",f)}if(!o)return void i({url:"/pages/login/login"});this.user=o;const c=`signin_${o.id}`,r=n(c)||{points:0,lastDate:""};this.points=r.points||0;const d=(new Date).toDateString();this.isSignedToday=r.lastDate===d}else{const e=o().filter((e=>String(e.authorId)===String(this.targetUserId)));if(this.points=10*e.length,e.length>0){const s=e[0];this.user.name=s.authorName,this.user.avatar=s.authorAvatar}}const r=o(),d=this.isMe?this.user.id:this.targetUserId;this.myPosts=r.filter((e=>String(e.authorId)===String(d))),this.myPosts.forEach((e=>{if("circle"===e.categoryId)e.categoryName=`å¹æ°´å»£å ´ - ${e.subCategoryId||""}`;else{const s=c.find((s=>s.id===e.categoryId));if(s){if(e.categoryName=s.name,e.subCategoryId&&s.children){const t=s.children.find((s=>s.id===e.subCategoryId));t&&(e.categoryName+=` - ${t.name}`)}}else e.categoryName="æœªåˆ†é¡ž"}}))},handleCheckIn(){if(this.isSignedToday)return;const e=u(this.user);e.isNew&&(this.points=e.points,this.isSignedToday=!0,r({title:"ç°½åˆ°æˆåŠŸ +5 äººæ°£å€¼",icon:"none"}))},editProfile(){i({url:"/pages/profile/edit"})},showMyPosts(){i({url:"/pages/profile/user-posts?type=discussion",fail:e=>{console.error("Navigate failed:",e),r({title:"è·³è½‰å¤±æ•—: "+JSON.stringify(e),icon:"none"})}})},showMyAuctions(){i({url:"/pages/profile/user-posts?type=auction",fail:e=>{console.error("Navigate failed:",e),r({title:"è·³è½‰å¤±æ•—: "+JSON.stringify(e),icon:"none"})}})},showMessages(){d({url:"/pages/message/message",fail:()=>{i({url:"/pages/message/message"})}})},showLikes(){i({url:"/pages/profile/likes"})},showFavorites(){i({url:"/pages/profile/favorites"})},showAchievements(){i({url:"/pages/profile/user-achievement",fail:e=>{console.error("Navigate failed:",e),r({title:"è·³è½‰å¤±æ•—: "+JSON.stringify(e),icon:"none"})}})},contactUs(){f({title:"è¯ç¹«æˆ‘å€‘",content:"å¦‚æœ‰ä»»ä½•å•é¡Œï¼Œè«‹é›»éƒµè‡³ raychan19999@gmail.com",showCancel:!1})},logout(){f({title:"ç™»å‡º",content:"ç¢ºå®šè¦ç™»å‡ºå—Žï¼Ÿ",success:e=>{e.confirm&&(m("currentUser"),g({url:"/pages/login/login"}))}})},viewPost(e){i({url:`/pages/detail/detail?id=${e}`})},formatDate(e){if(!e)return"";const s=new Date(e<1e10?1e3*e:e);return`${s.getFullYear()}/${s.getMonth()+1}/${s.getDate()}`},startChat(){this.targetUserId&&i({url:`/pages/message/chat?targetId=${this.targetUserId}&targetName=${encodeURIComponent(this.user.name)}`})}}},[["render",function(e,s,t,a,l,i){const n=U,o=p,c=N,u=x;return y(),h(o,{class:"container"},{default:_((()=>[v(o,{class:"notice-bar"},{default:_((()=>[v(o,{class:"notice-content"},{default:_((()=>[v(n,{class:"notice-text"},{default:_((()=>[k("ðŸ“¢ æœ¬ç‰ˆç‰ˆè¦ï¼šåš´ç¦ç™¼ä½ˆä»»ä½•è‰²æƒ…ã€æš´åŠ›ã€è³­åšåŠè©é¨™è¨Šæ¯ã€‚è«‹ä¿æŒç¦®è²Œï¼Œå°Šé‡ä»–äººã€‚é•è€…å°‡è¢«å°ç¦ã€‚")])),_:1})])),_:1})])),_:1}),v(o,{class:"profile-header"},{default:_((()=>[v(o,{class:"user-info-box"},{default:_((()=>[v(o,{class:"avatar-container"},{default:_((()=>[v(c,{src:l.user.avatar||"/static/logo.png",class:"avatar",mode:"aspectFill"},null,8,["src"]),v(o,{class:"level-badge"},{default:_((()=>[k("Lv."+C(i.level),1)])),_:1})])),_:1}),v(o,{class:"user-details"},{default:_((()=>[v(n,{class:"username"},{default:_((()=>[k(C(l.user.name)+" ",1),l.isAdmin?(y(),h(n,{key:0,class:"role-badge admin"},{default:_((()=>[k("å®˜æ–¹")])),_:1})):b("",!0),l.isMod?(y(),h(n,{key:1,class:"role-badge mod"},{default:_((()=>[k("ç‰ˆä¸»")])),_:1})):b("",!0)])),_:1}),l.isMe?(y(),h(n,{key:0,class:"user-email"},{default:_((()=>[k(C(l.user.email),1)])),_:1})):b("",!0),v(o,{class:"user-tags"},{default:_((()=>[v(n,{class:"tag"},{default:_((()=>[k(C(i.levelTitle),1)])),_:1}),v(n,{class:"tag points"},{default:_((()=>[k("ðŸ”¥ äººæ°£ "+C(l.points),1)])),_:1})])),_:1})])),_:1})])),_:1}),l.isMe?(y(),h(o,{key:0,class:"action-buttons"},{default:_((()=>[v(o,{class:"action-btn edit-btn",onClick:i.editProfile},{default:_((()=>[v(n,null,{default:_((()=>[k("ç·¨è¼¯è³‡æ–™")])),_:1})])),_:1},8,["onClick"]),v(o,{class:I(["action-btn sign-in-btn",{signed:l.isSignedToday}]),onClick:i.handleCheckIn},{default:_((()=>[v(n,null,{default:_((()=>[k(C(l.isSignedToday?"âœ… å·²ç°½åˆ°":"ðŸ“… æ¯æ—¥ç°½åˆ°"),1)])),_:1})])),_:1},8,["class","onClick"])])),_:1})):(y(),h(o,{key:1,class:"action-buttons"},{default:_((()=>[v(o,{class:"action-btn message-btn",onClick:i.startChat},{default:_((()=>[v(n,null,{default:_((()=>[k("ðŸ’¬ ç§è¨Š")])),_:1})])),_:1},8,["onClick"])])),_:1}))])),_:1}),l.isMe?(y(),h(o,{key:0,class:"menu-grid"},{default:_((()=>[v(o,{class:"menu-item",onClick:i.showMyPosts},{default:_((()=>[v(o,{class:"menu-icon-bg"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("ðŸ“")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("æˆ‘çš„å¸–å­")])),_:1})])),_:1},8,["onClick"]),v(o,{class:"menu-item",onClick:i.showMyAuctions},{default:_((()=>[v(o,{class:"menu-icon-bg"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("ðŸ”¨")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("æˆ‘çš„æ‹è³£")])),_:1})])),_:1},8,["onClick"]),v(o,{class:"menu-item",onClick:i.showMessages},{default:_((()=>[v(o,{class:"menu-icon-bg"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("ðŸ’¬")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("æˆ‘çš„ç§ä¿¡")])),_:1})])),_:1},8,["onClick"]),v(o,{class:"menu-item",onClick:i.showLikes},{default:_((()=>[v(o,{class:"menu-icon-bg"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("â¤ï¸")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("è®šå¥½å…§å®¹")])),_:1})])),_:1},8,["onClick"]),v(o,{class:"menu-item",onClick:i.showFavorites},{default:_((()=>[v(o,{class:"menu-icon-bg"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("â­")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("æˆ‘çš„æ”¶è—")])),_:1})])),_:1},8,["onClick"]),v(o,{class:"menu-item",onClick:i.showAchievements},{default:_((()=>[v(o,{class:"menu-icon-bg"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("ðŸ†")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("æˆ‘çš„æˆå°±")])),_:1})])),_:1},8,["onClick"]),v(o,{class:"menu-item",onClick:i.contactUs},{default:_((()=>[v(o,{class:"menu-icon-bg"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("ðŸ“ž")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("è¯ç¹«æˆ‘å€‘")])),_:1})])),_:1},8,["onClick"]),v(o,{class:"menu-item",onClick:i.logout},{default:_((()=>[v(o,{class:"menu-icon-bg logout"},{default:_((()=>[v(n,{class:"menu-emoji"},{default:_((()=>[k("ðŸšª")])),_:1})])),_:1}),v(n,{class:"menu-text"},{default:_((()=>[k("ç™»å‡º")])),_:1})])),_:1},8,["onClick"])])),_:1})):b("",!0),v(o,{class:"section-header"},{default:_((()=>[v(n,{class:"section-title"},{default:_((()=>[k("æˆ‘çš„å‹•æ…‹")])),_:1})])),_:1}),v(u,{"scroll-y":"",class:"posts-list"},{default:_((()=>[0===l.myPosts.length?(y(),h(o,{key:0,class:"empty-state"},{default:_((()=>[v(n,null,{default:_((()=>[k("ä½ é‚„æ²’æœ‰ç™¼ä½ˆéŽå¸–å­")])),_:1})])),_:1})):(y(!0),M(S,{key:1},w(l.myPosts,(e=>(y(),h(o,{class:"post-item",key:e.id,onClick:s=>i.viewPost(e.id)},{default:_((()=>[v(n,{class:"post-title"},{default:_((()=>[k(C(e.title),1)])),_:2},1024),v(n,{class:"post-meta"},{default:_((()=>[k(C(e.categoryName||"æœªåˆ†é¡ž")+" Â· "+C(i.formatDate(e.timestamp)),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})}],["__scopeId","data-v-255e15b3"]]);export{D as default};
